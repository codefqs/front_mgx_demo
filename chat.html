<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light" />
  <title>聊天 - MGX</title>
  <link rel="stylesheet" href="./style.css" />
  <link rel="stylesheet" href="./chat.css" />
</head>
<body>
  <!-- 顶部导航栏 -->
  <header class="header">
    <div class="container">
      <nav class="nav">
        <div class="nav-left">
          <a href="index.html" class="logo">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="currentColor"/>
              <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2"/>
              <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span>MGX</span>
          </a>
          <ul class="nav-menu">
            <li><a href="index.html">学习</a></li>
            <li><a href="#">定价</a></li>
            <li><a href="#">资源</a></li>
            <li><a href="#">合作伙伴</a></li>
            <li><a href="#">黑客松活动</a></li>
          </ul>
        </div>
        <div class="nav-right">
          <button class="lang-switch" data-action="toggleLang">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
              <path d="M2 8h12M8 2c1.5 2 2 4 2 6s-.5 4-2 6M8 2c-1.5 2-2 4-2 6s.5 4 2 6" stroke="currentColor" stroke-width="1.5"/>
            </svg>
            <span>中文</span>
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
              <path d="M3 5L6 8L9 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </button>
          <div class="user-info-nav" id="userInfoNav" style="display: none;">
            <div class="user-avatar">
              <span id="userInitial">U</span>
            </div>
            <span id="userName">用户</span>
          </div>
          <a href="login.html" class="auth-btn login-btn" id="loginBtn">登录</a>
          <a href="register.html" class="auth-btn register-btn" id="registerBtn">注册</a>
          <div class="social-links">
            <a href="#" aria-label="Twitter">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
            </a>
            <a href="#" aria-label="Discord">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"/>
              </svg>
            </a>
            <a href="#" aria-label="LinkedIn">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
            </a>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <!-- 聊天主体 -->
  <main class="chat-main">
    <div class="chat-container">
      <!-- 聊天消息区 -->
      <div class="chat-messages" id="chatMessages">
        <div class="chat-welcome">
          <div class="welcome-icon">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
              <circle cx="32" cy="32" r="30" fill="url(#gradient2)" opacity="0.2"/>
              <circle cx="32" cy="32" r="24" fill="url(#gradient2)"/>
              <path d="M32 20v24M20 32h24" stroke="white" stroke-width="3" stroke-linecap="round"/>
              <defs>
                <linearGradient id="gradient2" x1="0" y1="0" x2="64" y2="64">
                  <stop offset="0%" stop-color="#60a5fa"/>
                  <stop offset="100%" stop-color="#a78bfa"/>
                </linearGradient>
              </defs>
            </svg>
          </div>
          <h2>开始与 AI 对话</h2>
          <p>输入您的问题，我会尽力帮助您</p>
        </div>
      </div>

      <!-- 输入区 -->
      <div class="chat-input-container">
        <div class="chat-input-wrapper">
          <button class="chat-add-btn" data-action="addFile" aria-label="添加文件">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M10 4v12M4 10h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
          <input type="text" class="chat-input" id="chatInput" placeholder="输入您的消息..." />
          <button class="chat-emoji-btn" data-action="openEmoji" aria-label="表情">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1.5"/>
              <circle cx="7" cy="8" r="1" fill="currentColor"/>
              <circle cx="13" cy="8" r="1" fill="currentColor"/>
              <path d="M6 12c1 2 3 3 4 3s3-1 4-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </button>
          <button class="chat-send-btn" id="chatSendBtn" aria-label="发送">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M18 2L9 11M18 2l-6 16-3-7-7-3 16-6z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
        <div class="chat-model-info">
          <span>Deepseek R1</span>
        </div>
      </div>
    </div>
  </main>

  <!-- 左侧侧边栏 -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <button class="new-chat-btn" data-action="newChat">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <path d="M10 4v12M4 10h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span>新建聊天</span>
      </button>
    </div>

    <div class="sidebar-content">
      <a href="index.html" class="sidebar-link">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <rect x="3" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
          <rect x="11" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
          <rect x="3" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
          <rect x="11" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
        </svg>
        <span>前往应用世界</span>
      </a>

      <div class="sidebar-section">
        <div class="sidebar-section-header" data-action="toggleHistory">
          <span>我的聊天记录</span>
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="expand-icon">
            <path d="M6 4l4 4-4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </div>

        <div class="chat-history" id="chatHistory">
          <div class="history-group">
            <div class="history-group-title">最近</div>
            <div class="history-list" id="historyList">
              <!-- 历史聊天记录将动态插入这里 -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-footer">
      <div class="user-card">
        <div class="user-card-header">
          <div class="user-avatar-large">
            <span id="sidebarUserInitial">U</span>
          </div>
          <div class="user-card-info">
            <div class="user-card-name" id="sidebarUserName">用户名</div>
            <div class="user-card-badge">Pro 70</div>
          </div>
          <button class="user-card-menu" data-action="toggleUserMenu" aria-label="更多选项">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" class="menu-arrow">
              <path d="M6 8l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </button>
        </div>

        <!-- 用户选项菜单 -->
        <div class="user-menu" id="userMenu">
          <button class="user-menu-item" data-action="openSettings">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <circle cx="9" cy="9" r="2" stroke="currentColor" stroke-width="1.5"/>
              <path d="M9 1v2M9 15v2M17 9h-2M3 9H1M14.5 3.5l-1.4 1.4M4.9 13.1l-1.4 1.4M14.5 14.5l-1.4-1.4M4.9 4.9L3.5 3.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>设置</span>
          </button>
          
          <button class="user-menu-item" data-action="openBilling">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <rect x="2" y="4" width="14" height="10" rx="1" stroke="currentColor" stroke-width="1.5"/>
              <path d="M2 7h14" stroke="currentColor" stroke-width="1.5"/>
            </svg>
            <span>套餐与账单</span>
          </button>
          
          <button class="user-menu-item" data-action="openHelp">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="1.5"/>
              <path d="M9 13v.5M9 6.5c0-1 .5-1.5 1.5-1.5s1.5.5 1.5 1.5-.5 1.5-1.5 1.5H9v2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>帮助中心</span>
          </button>
          
          <button class="user-menu-item" data-action="openRedeem">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <rect x="3" y="6" width="12" height="9" rx="1" stroke="currentColor" stroke-width="1.5"/>
              <path d="M6 6V4.5C6 3.7 6.7 3 7.5 3h3c.8 0 1.5.7 1.5 1.5V6M9 11v2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>兑换</span>
          </button>
          
          <button class="user-menu-item" data-action="openPreferences">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <path d="M2 5h14M2 9h14M2 13h14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>偏好设置</span>
          </button>
          
          <div class="user-menu-item theme-toggle">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <circle cx="9" cy="9" r="4" stroke="currentColor" stroke-width="1.5"/>
              <path d="M9 1v2M9 15v2M17 9h-2M3 9H1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>主题</span>
            <div class="theme-icons">
              <button class="theme-icon" data-theme="light" aria-label="浅色">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <circle cx="8" cy="8" r="3" fill="currentColor"/>
                  <path d="M8 1v2M8 13v2M15 8h-2M3 8H1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
              </button>
              <button class="theme-icon" data-theme="dark" aria-label="深色">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <path d="M14 9c-3.3 0-6-2.7-6-6 0-.8.2-1.6.5-2.3C5.3 1.4 3 4.3 3 7.7c0 3.9 3.1 7 7 7 2.8 0 5.2-1.6 6.3-4-.8.2-1.6.3-2.3.3z" fill="currentColor"/>
                </svg>
              </button>
              <button class="theme-icon" data-theme="auto" aria-label="自动">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <rect x="2" y="2" width="12" height="12" rx="1" stroke="currentColor" stroke-width="1.5"/>
                  <path d="M2 8h12" stroke="currentColor" stroke-width="1.5"/>
                </svg>
              </button>
            </div>
          </div>
          
          <button class="user-menu-item logout-item" data-action="logout">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <path d="M7 16H3c-.6 0-1-.4-1-1V3c0-.6.4-1 1-1h4M12 13l4-4-4-4M16 9H7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>退出登录</span>
          </button>
        </div>

        <div class="credits-info">
          <div class="credits-header">
            <span>剩余积分</span>
            <a href="#" class="upgrade-link" data-action="openBilling">升级</a>
          </div>
          <div class="credits-bar">
            <div class="credits-progress" id="creditsProgress" style="width: 67.09%"></div>
          </div>
          <div class="credits-amount" id="creditsAmount">334.58 剩余</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 套餐与账单弹窗 -->
  <div class="billing-modal" id="billingModal">
    <div class="billing-modal-overlay" data-action="closeBilling"></div>
    <div class="billing-modal-content">
      <div class="billing-modal-header">
        <h2>套餐与账单</h2>
        <span class="billing-badge">Pro 70</span>
        <button class="billing-modal-close" data-action="closeBilling" aria-label="关闭">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <div class="billing-credits-section">
        <div class="billing-credits-header">
          <span>剩余积分</span>
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
            <path d="M8 11v.5M8 5v4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="billing-credits-bar">
          <div class="billing-credits-progress" id="billingCreditsProgress"></div>
        </div>
        <div class="billing-credits-info">
          <span class="billing-credits-amount" id="billingCreditsAmount">317.13 / 357.5</span>
          <span class="billing-credits-total" id="billingCreditsTotal">317.13 剩余</span>
        </div>
        <div class="billing-credits-expiry">
          <span id="billingCreditsExpiry">350 积分的凭据日期为 11月22日</span>
        </div>
        <div class="billing-credits-cycle">
          <span id="billingCreditsCycle">当前周期从 2025年12月6日 到 15/25</span>
        </div>
      </div>

      <div class="billing-tabs">
        <button class="billing-tab active" data-tab="plans" data-action="switchBillingTab">
          <span>套餐</span>
        </button>
        <button class="billing-tab" data-tab="payments" data-action="switchBillingTab">
          <span>支付</span>
        </button>
        <a href="#" class="billing-overview-link">
          数据概览
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
            <path d="M10 3h1v1M11 3L6 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </a>
      </div>

      <div class="billing-tab-content" id="billingTabContent">
        <!-- 套餐 Tab -->
        <div class="billing-plans-content" id="plansContent">
          <div class="billing-current-plan">
            <span class="billing-plan-badge">标准</span>
            <span class="billing-plan-save">节省 21%</span>
          </div>

          <div class="billing-plans-grid">
            <!-- Free Plan -->
            <div class="billing-plan-card">
              <h3 class="billing-plan-name">Free</h3>
              <div class="billing-plan-price">
                <span class="price">$0</span>
                <span class="period">/ 月</span>
              </div>
              <p class="billing-plan-desc">入门级用户</p>
              <div class="billing-plan-credits">7.5 积分 / 天</div>
              <button class="billing-plan-btn disabled">续级</button>
              <ul class="billing-plan-features">
                <li>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M13 4L6 11 3 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span>7.5 每日积分（最多 25 / 月）</span>
                </li>
                <li>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M13 4L6 11 3 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span>2GB 磁盘空间</span>
                </li>
                <li>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M13 4L6 11 3 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span>无限项目共享</span>
                </li>
              </ul>
            </div>

            <!-- Pro Plan -->
            <div class="billing-plan-card current">
              <h3 class="billing-plan-name">Pro</h3>
              <div class="billing-plan-price">
                <span class="price">$70</span>
                <span class="period">/ 月</span>
              </div>
              <p class="billing-plan-desc">解锁更多功能</p>
              <select class="billing-plan-select">
                <option value="350">350 积分 / 月</option>
                <option value="500">500 积分 / 月</option>
                <option value="1000">1000 积分 / 月</option>
              </select>
              <button class="billing-plan-btn current">签当前计划</button>
              <ul class="billing-plan-features">
                <li>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M13 4L6 11 3 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span>7.5 每日积分（最多 25 / 月）</span>
                </li>
                <li>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M13 4L6 11 3 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span>350 每月积分</span>
                </li>
                <li>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M13 4L6 11 3 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span>10GB 磁盘空间</span>
                </li>
              </ul>
            </div>

            <!-- Max Plan -->
            <div class="billing-plan-card">
              <h3 class="billing-plan-name">Max</h3>
              <div class="billing-plan-price">
                <span class="price">$100</span>
                <span class="period">/ 月</span>
              </div>
              <p class="billing-plan-desc">全功能的MGX最佳体验</p>
              <select class="billing-plan-select">
                <option value="500">500 积分 / 月</option>
                <option value="750">750 积分 / 月</option>
                <option value="1000">1000 积分 / 月</option>
              </select>
              <button class="billing-plan-btn">升级</button>
              <ul class="billing-plan-features">
                <li>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M13 4L6 11 3 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span>7.5 每日积分（最多 25 / 月）</span>
                </li>
                <li>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M13 4L6 11 3 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span>500 每月积分</span>
                </li>
                <li>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M13 4L6 11 3 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span>40GB 磁盘空间</span>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- 支付 Tab -->
        <div class="billing-payments-content" id="paymentsContent" style="display: none;">
          <div class="billing-payments-empty">
            <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
              <circle cx="32" cy="32" r="30" stroke="currentColor" stroke-width="2" opacity="0.2"/>
              <path d="M20 28h24M20 36h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <p>暂无支付记录</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 侧边栏遮罩 -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- 左侧触发区域 -->
  <div class="sidebar-trigger" id="sidebarTrigger"></div>

  <script src="./chat.js"></script>
</body>
</html>